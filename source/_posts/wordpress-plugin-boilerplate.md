---
title: ã€ å¿ƒå¾— ã€‘WordPress å¤–æ›é–‹ç™¼æ—¥è¨˜ (ä¸€) - æ¶æ§‹
date: 2021-06-15 18:00:00
categories:
- å¤–æ›é–‹ç™¼
tags:
- boilerplate
- composer
- phpcs
- git
etoc: false
---

ä¸€å¹´å‰çš„é€™å€‹æ™‚å€™ï¼Œå¾æ—©åˆ°æ™šéƒ½åœ¨è·Ÿ WordPress çš„ä½ˆæ™¯ä¸»é¡Œæ‰“äº¤é“ï¼Œé™¤äº†å¿™æ¡ˆå­ä»¥å¤–ï¼Œç©ºæª”æ™‚å°±åœ¨ç ”ç©¶å“ªäº›å‰ç«¯æ¡†æ¶å¯ä»¥æ›´å¿«é€Ÿçš„èˆ‡ WordPress åšæ•´åˆï¼Œæƒ³ä¸åˆ°åäºŒå€‹æœˆéå»äº†ï¼Œç¾åœ¨æ¯å¤©éƒ½æ”¹æˆåœ¨å¯«å¤–æ›ï¼Œé›¢å‰ç«¯ç¨‹å¼é–‹ç™¼è¶Šä¾†è¶Šé ï¼Œåœä¸‹è…³æ­¥å›é ­ä¾†çœ‹ï¼Œæ„Ÿè¦ºæ˜¯è©²ä¾†å¥½å¥½æ•´ç†ä¸€ä¸‹é€™é™£å­çš„é–‹ç™¼å¿ƒå¾—äº†ã€‚

ç‚ºäº†æ–¹ä¾¿é–±è®€æˆ‘æ‹†æˆä»¥ä¸‹å¹¾å€‹ç« ç¯€ä¾†ç´€éŒ„ï¼š

[ä¸€ã€WordPress å¤–æ›æ¶æ§‹ - ç´€éŒ„æ›¾ç¶“ä½¿ç”¨éçš„æ¶æ§‹ä»¥åŠç›®å‰ä½œæ³•](https://oberonlai.blog/tw/wordpress-plugin-boilerplate)
[äºŒã€WordPress é–‹ç™¼å¯¦ç”¨ Composer å¥—ä»¶ - ä»‹ç´¹åœ¨å¯«å¤–æ›çš„æ™‚å€™å¯ä»¥åŠ é€Ÿé–‹ç™¼çš„å¥—ä»¶](https://oberonlai.blog/tw/wordpress-and-composer)
ä¸‰ã€è¼‰å…¥ä½ˆæ™¯ä¸»é¡Œç¯„æœ¬ - å¦‚ä½•åœ¨å¤–æ›è£¡é¢ä½¿ç”¨ç¯„æœ¬æª”ä¿®æ”¹å‰ç«¯ä»‹é¢ä¸¦æ•´åˆå‰ç«¯é–‹ç™¼æµç¨‹
å››ã€æ•´åˆ PHPUnit å–®å…ƒæ¸¬è©¦ - é¿å…æ”¹æ±ç‰†å£è¥¿ç‰†çš„å•é¡Œå†æ¬¡ç™¼ç”Ÿ
äº”ã€è‡ªå‹•åŒ–éƒ¨ç½² - è®“ WordPress æ­ä¸Š DevOps çš„åˆ—è»ŠğŸš„
å…­ã€WordPress å¤–æ›æ›´æ–° - è‡ªè¡Œç®¡ç†æœªä¸Šæ¶ wordpress.org çš„å¤–æ›ç‰ˆæœ¬ç¶­è­·

å¦‚æœæ˜¯å° WordPress å¤–æ›é–‹ç™¼å®Œå…¨æ²’æ¦‚å¿µçš„æœ‹å‹ï¼Œæˆ‘å»ºè­°å…ˆé–±è®€ [Plugin Developer Handbook](https://developer.wordpress.org/plugins/) æœƒæ¯”è¼ƒå®Œæ•´ï¼Œæˆ–æ˜¯è²·[é€™æœ¬æ›¸](https://oberonlai.blog/tw/building-web-apps-with-wordpress/)ä¾†çœ‹åœ¨å­¸ç¿’ä¸Šæœƒæ¯”è¼ƒæœ‰è„ˆçµ¡èˆ‡ç³»çµ±æ€§ã€‚è€Œé€™ç³»åˆ—æ–‡æ˜¯æˆ‘çš„å¯¦å‹™ç¶“é©—ï¼Œæ‰€ä»¥å¾ˆå¤šåœ°æ–¹å¯èƒ½é‚„æ˜¯æœƒæœ‰ä¸è¶³ä¹‹è™•ï¼Œå¸Œæœ›èƒ½é‡åˆ°å¤§å¤§å†å¹«æˆ‘æŒ‡é»è¿·æ´¥äº† ğŸ™

ç¬¬ä¸€ç¯‡æ–‡ç« ä¸»è¦ç´€éŒ„äº†æˆ‘åœ¨çµ„ç¹”å¤–æ›çµæ§‹çš„éç¨‹ï¼Œä¸¦é€éä¸æ–·çš„æ‰“æ‰é‡ç·´ä¾†æ‰¾åˆ°è‡ªå·±æœ€èˆ’æœçš„æ–¹å¼ï¼Œè®“æˆ‘å€‘é–‹å§‹å§ï½

<!--more-->

é›–ç„¶ä¸çŸ¥é“å‡ºä¾†æ··ç‚ºä½•ä¸€å®šè¦é‚„ï¼Œä½†é‚„æ˜¯æ‰‹ç™¢é–‹å§‹æŠŠé€™ä¸€å¹´å¤šä¾†æ”¹å¯«å¤–æ›çš„æ—¥å¸¸ç´€éŒ„ä¸€ä¸‹XDï¼Œå¾é–‹å§‹å…¥å‘ Composer åˆ°å­¸è‘—å¯«ä¸‹ç¬¬ä¸€è¡Œå–®å…ƒæ¸¬è©¦ï¼Œå†åˆ°å¤–æ›çš„è‡ªç®¡æ›´æ–°ä»¥åŠè‡ªå‹•åŒ–éƒ¨ç½²ï¼Œå¯«åˆ°ä¸€åŠç™¼ç¾é¤…è¯å¤ªå¤§ï¼Œåªå¥½æ‹†æˆå¤šç¯‡ä¾†å¯« > < ç¬¬ä¸€ç¯‡ä»‹ç´¹ç›®å‰æˆ‘æ…£ç”¨çš„ Starter Plugin ( å¥½åƒæ²’é€™ç¨®èªªæ³•XD ) èˆ‡å·¥ä½œæµç¨‹ï¼Œä»¥åŠéš¨è‘—æ™‚é–“æ¼”é€²çš„çµ„ç¹”æ–¹æ³•ï¼Œæ‰€ä»¥è¬ä¸€æ˜å¤©é»é–‹ä¾†çœ‹ç™¼ç¾è·Ÿä»Šå¤©çœ‹åˆ°çš„å…§å®¹ä¸ä¸€æ¨£é‚„è«‹è¦‹è«’ï¼Œæ–‡ç« ä¹Ÿæ˜¯éœ€è¦é‡æ§‹çš„XD æ–‡ä¸­å¦‚æœ‰ä¸è¶³ä¹‹è™•é‚„ç…©è«‹å¤§å¤§æŒ‡é»è¿·æ´¥äº† ğŸ™

## WordPress å¤–æ›æ¶æ§‹

ä»¥ä½ˆæ™¯ä¸»é¡Œä¾†èªªï¼Œæœ‰å¾ˆå¤šå…¬å¸æ¨å‡ºåˆå§‹ä½ˆæ™¯ä¸»é¡Œ ( Starter Theme ) å¯ä»¥å…¥é–€ï¼Œç›¸è¼ƒä¹‹ä¸‹å¤–æ›å°±å°‘å¾ˆå¤šï¼ŒåŸå› å¯èƒ½æ˜¯å¤–æ›çš„çµ„ç¹”æ–¹å¼å¤ªè‡ªç”±äº†ï¼ŒåŸºæœ¬ä¸Šæˆ‘å¯ä»¥æŠŠæ‰€æœ‰çš„ç¨‹å¼ç¢¼å…¨éƒ½å¡é€²åˆ°å¸¶æœ‰æ¨™é ­çš„ PHP æª”æ¡ˆå³å¯ï¼Œä¸éœ€è¦æ‹†åˆ†ä»»ä½•æª”æ¡ˆèˆ‡è³‡æ–™å¤¾ï¼Œä½†å¦‚æœæ˜¯åšåŠŸèƒ½è¤‡é›œæˆ–æ˜¯å¤§å‹å¤–æ›çš„æ“´å……ï¼Œé€™æ¨£åšæœƒè¢«æœªä¾†çš„è‡ªå·±ç½µåˆ°è‡­é ­XD

å‰›é–‹å§‹å¯¦ä½œçš„æ™‚å€™æˆ‘æ˜¯æ¡ç”¨ã€Œ [WordPress Plugin Boilerplate Generator](https://wppb.me)ã€ï¼Œä¸ç®¡è¦åšçš„åŠŸèƒ½æ˜¯å¤§é‚„æ˜¯å°ï¼Œæˆ‘è¦ºå¾—éµå¾ªé€™å¥—æ¶æ§‹å¯ä»¥è®“æª”æ¡ˆå¾ˆæœ‰é‚è¼¯èˆ‡ç³»çµ±ï¼Œå®ƒçš„ç‰¹è‰²æ˜¯åœ¨æ–¼æŠŠå‰å¾Œå°çš„è³‡æ–™å¤¾åˆ‡åˆ†é–‹ä¾†ï¼Œç„¶å¾Œé€éä¸€å±¤åˆä¸€å±¤çš„é¡åˆ¥ä¾†åšè¼‰å…¥ã€‚

```
â”€â”€ LICENSE.txt
â”œâ”€â”€ README.txt
â”œâ”€â”€ admin
â”‚Â Â  â”œâ”€â”€ class-my-plugin-admin.php
â”‚Â Â  â”œâ”€â”€ css
â”‚Â Â  â”‚Â Â  â””â”€â”€ my-plugin-admin.css
â”‚Â Â  â”œâ”€â”€ index.php
â”‚Â Â  â”œâ”€â”€ js
â”‚Â Â  â”‚Â Â  â””â”€â”€ my-plugin-admin.js
â”‚Â Â  â””â”€â”€ partials
â”‚Â Â      â””â”€â”€ my-plugin-admin-display.php
â”œâ”€â”€ includes
â”‚Â Â  â”œâ”€â”€ class-my-plugin-activator.php
â”‚Â Â  â”œâ”€â”€ class-my-plugin-deactivator.php
â”‚Â Â  â”œâ”€â”€ class-my-plugin-i18n.php
â”‚Â Â  â”œâ”€â”€ class-my-plugin-loader.php
â”‚Â Â  â”œâ”€â”€ class-my-plugin.php
â”‚Â Â  â””â”€â”€ index.php
â”œâ”€â”€ index.php
â”œâ”€â”€ languages
â”‚Â Â  â””â”€â”€ my-plugin.pot
â”œâ”€â”€ my-plugin.php
â”œâ”€â”€ public
â”‚Â Â  â”œâ”€â”€ class-my-plugin-public.php
â”‚Â Â  â”œâ”€â”€ css
â”‚Â Â  â”‚Â Â  â””â”€â”€ my-plugin-public.css
â”‚Â Â  â”œâ”€â”€ index.php
â”‚Â Â  â”œâ”€â”€ js
â”‚Â Â  â”‚Â Â  â””â”€â”€ my-plugin-public.js
â”‚Â Â  â””â”€â”€ partials
â”‚Â Â      â””â”€â”€ my-plugin-public-display.php
â””â”€â”€ uninstall.php
```

ä½†ç¶“éå¹¾å€‹å°ˆæ¡ˆå¾Œç™¼ç¾ä¸å¤ªé †æ‰‹ï¼Œå•é¡Œåœ¨æ–¼å®ƒæŠŠå‹¾é» ( Hook ) è·Ÿè¦è·‘åœ¨å‹¾é»ä¸Šçš„å‡½å¼åˆ‡é–‹ä¾†ï¼Œå¸¸å¸¸åœ¨æ‰¾é€™æ”¯å‡½å¼æ˜¯è·‘åœ¨å“ªå€‹å‹¾é»ä¸Šæ™‚æœƒèŠ±ä¸Šä¸€äº›æ™‚é–“ï¼Œæ›´ä¸ç”¨èªªåœ¨å¯«å‹¾é»çš„æ™‚å€™é‚„éœ€è¦åˆ‡æ›æª”æ¡ˆå¾ˆå®¹æ˜“æ··äº‚ã€‚

å…¶æ¬¡æ˜¯å¾ˆå¤šåŠŸèƒ½å¾ˆé›£ç•Œå®šå®ƒåˆ°åº•æ˜¯å±¬æ–¼å‰å°é‚„å¾Œå°ï¼Œåƒæ˜¯åœ¨åš REST API æˆ‘æœ‰æ™‚å€™æœƒæ”¾åœ¨ publicï¼Œæœ‰æ™‚å€™å¿˜è¨˜åˆæœƒæ”¾åœ¨ adminï¼Œè¦æ‰¾çš„æ™‚å€™è‡ªå·±éƒ½æœƒææ··ã€‚

ç„¶å¾Œæœ€éº»ç…©çš„åœ°æ–¹æ˜¯æª”æ¡ˆçš„è¼‰å…¥ï¼ŒWPPB æ˜¯ä½¿ç”¨ require çš„æ–¹å¼ä¾†å¼•å…¥ï¼Œæ‰€ä»¥å¦‚æœæ–°å¢æª”æ¡ˆæˆ–æ˜¯ä¿®æ”¹æª”åçš„æ™‚å€™éƒ½æœƒéœ€è¦æ‰‹å‹•ä¿®æ”¹ï¼Œæœ€å¸¸ç™¼ç”Ÿçš„æƒ…æ³å°±æ˜¯é¡åˆ¥å¯«å®Œå¾Œä¸€ç›´è·‘ä¸å‹•ï¼Œè¿½æŸ¥å¾Œæ‰ç™¼ç¾æ ¹æœ¬å¿˜è¨˜å¼•å…¥äº† ğŸ˜…

æ‰€ä»¥ä¸€ç›´åœ¨æ‰¾å°‹è‘—æœ‰æ²’æœ‰æ›´å¥½çš„æ¶æ§‹å¯ä»¥ä¾†é–‹ç™¼å¤–æ›ï¼Œæ‰¾äº†è€åŠå¤©éƒ½æ²’æœ‰é©åˆè‡ªå·±çš„ï¼Œç´¢æ€§å°±ä¾†ç™¼å±•ä¸€å¥—è‡ªå·±çš„é‚è¼¯å§ï½

å‰›å¥½ç•¶æ™‚åœ¨çœ‹ã€Œ[ç¾ä»£ PHP](https://www.books.com.tw/products/0010688181) ã€é€™æœ¬æ›¸ï¼Œå°æ–¼ Composer å¾ˆæœ‰èˆˆè¶£ï¼Œå°±é–‹å§‹è©¦è‘—æŠŠ Composer æ•´åˆé€² WordPress çš„é–‹ç™¼æµç¨‹ä¹‹ä¸­ã€‚

Composer å¯ä»¥ç°¡å–®çš„ç†è§£ç‚ºæ˜¯ä¸€å¥—å¯ä»¥å®‰è£ PHP å¤–æ›çš„å·¥å…·ï¼Œå¯ä»¥æŠŠåˆ¥äººå¯«å¥½çš„ PHP é¡åˆ¥é€é Composer å®‰è£å¾Œé€²è¡Œä½¿ç”¨ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒé‚„å¯ä»¥å¹«åŠ©é–‹ç™¼è€…åšè‡ªå‹•è¼‰å…¥ã€å¥—ä»¶æ›´æ–°ç®¡ç†ï¼Œç”šè‡³é‚„å¯ä»¥å®‰è£ WP çš„å¤–æ›ï¼Œé€éå®ƒä¾†ç®¡ç† WP ç¶²ç«™çš„å¤–æ›ï¼Œä½ ä¹Ÿå¯ä»¥ä¸Šå‚³è‡ªå·±å¯«çš„å¥—ä»¶ï¼ŒæŠŠä¸€äº›å¸¸ç”¨çš„é¡åˆ¥æ‰“åŒ…å¥½å¾Œä¸Šå‚³ï¼Œä¸‹æ¬¡è¦ç”¨æ™‚ç›´æ¥é€é Composer é€²è¡Œå®‰è£ã€‚

æ›´å¤š Composer çš„å¯¦ä½œç´°ç¯€æœƒéš¨è‘—ä¸‹æ–‡é€ä¸€å¸¶åˆ°ï¼Œå›åˆ° WordPress å¤–æ›é–‹ç™¼æ¶æ§‹çš„éœ€æ±‚ï¼Œæˆ‘æƒ³è¦çš„æ˜¯å¯ä»¥ä¾ç…§å°ˆæ¡ˆè¦æ¨¡è‡ªè¡Œå¢åŠ è³‡æ–™å¤¾çµæ§‹ä»¥åŠæª”æ¡ˆå‘½åï¼Œå°¤å…¶æ˜¯å¤–æ›é–‹ç™¼çš„åˆæœŸåŠŸèƒ½é‚„å¾ˆé™½æ˜¥ï¼Œå¯èƒ½å¹¾å€‹æª”æ¡ˆå°±æå®šï¼Œç­‰åˆ°å¤–æ›ç™¼å±•çš„è¶Šä¾†è¶Šå¤§ï¼Œæˆ‘å¯ä»¥éš¨æ™‚èª¿æ•´æª”æ¡ˆçµæ§‹ä»¥ç¬¦åˆå•†æ¥­é‚è¼¯çš„è®Šå‹•ã€‚

åƒè€ƒäº†å¾ˆå¤šå…è²»èˆ‡ä»˜è²»å¤–æ›çš„çµæ§‹å¾Œï¼Œç›®å‰å·²ç™¼å±•å‡ºä¸€å¥—è‡ªå·±çš„ SOPï¼Œå¤§æ¦‚çš„é †åºå¦‚ä¸‹

### 1.å»ºç«‹åŸºæœ¬æ¶æ§‹

å»ºç«‹å¤–æ›çš„ç¬¬ä¸€æ­¥å°±æ˜¯åœ¨ wp-content/plugins åº•ä¸‹å»ºç«‹è³‡æ–™å¤¾ï¼Œç„¶å¾Œæ–°å¢ä¸»æª”æ¡ˆèˆ‡ src (source) è³‡æ–™å¤¾æ”¾ä¸»ç¨‹å¼ï¼Œé€™æ¨£å°±å®Œæˆæœ€åŸºæœ¬çš„çµæ§‹äº†ã€‚

```
my-plugin
â”œâ”€â”€ my-plugin.php
â””â”€â”€ src
```

å¦‚æœå°ˆæ¡ˆæœ‰å‰ç«¯çš„éƒ¨åˆ†éœ€è¦è™•ç†ï¼Œæˆ‘æœƒé–‹ assets è³‡æ–™å¤¾ï¼Œè£¡é¢æœƒæ”¾åœ–æª”ã€CSS èˆ‡ JavaScript ç­‰éœæ…‹æª”æ¡ˆï¼š

```
my-plugin
â””â”€â”€ assets
    â”œâ”€â”€ css
    â”‚   â”œâ”€â”€ admin.css
    â”‚   â””â”€â”€ public.css
    â”œâ”€â”€ img
    â”‚   â””â”€â”€ img1.jpg
    â””â”€â”€ js
        â”œâ”€â”€ admin.js
        â”œâ”€â”€ ajax.js
        â””â”€â”€ public.js
```

å‰å¾Œå°çš„éœæ…‹æª”å°±ç”¨æª”åä¾†å€åˆ†ï¼Œå‰å°å°±æ˜¯ public å¾Œå°æ˜¯ adminï¼Œå¦‚æœæœ‰éœ€è¦åš Ajax çš„ JS æª”ä¹Ÿæ˜¯æœƒæ”¾åœ¨é€™é‚Šã€‚å¦‚æœè¦é€²ä¸€æ­¥çš„æ•´åˆ Node.js ä¾†åšå‰ç«¯çš„æª”æ¡ˆç·¨è­¯ï¼Œassets ä¸‹é¢æœƒå†å€åˆ† src è·Ÿ distï¼Œç„¶å¾Œæ‰æ”¾ imgã€css èˆ‡ js è³‡æ–™å¤¾ï¼Œä¹‹å‰æœ‰å¯¦ä½œéæ•´åˆæœ€è¿‘éå¸¸ç´…çš„ CSS æ¡†æ¶ Tailwindcssï¼Œé€™éƒ¨åˆ†æœƒåœ¨ä¹‹å¾Œçš„æ–‡ç« æåˆ°ã€‚

å†ä¾†å¦‚æœé€™å€‹å¤–æ›æœ‰éœ€è¦è™•ç†ç¯„æœ¬çš„è©±ï¼Œæˆ‘æœƒå†å¦å¤–é–‹ä¸€å€‹ views è³‡æ–™å¤¾ï¼Œé€™è³‡æ–™å¤¾å°±åƒæ˜¯ä½ˆæ™¯ä¸»é¡Œä¸€æ¨£ï¼Œå°ˆé–€æ”¾ç¯„æœ¬æª”ï¼š

```
my-plugin
â””â”€â”€ views
    â”œâ”€â”€ loops
    â”‚   â””â”€â”€ post.php
    â”œâ”€â”€ page-about.php
    â”œâ”€â”€ page-contact.php
    â”œâ”€â”€ partials
    â”‚   â””â”€â”€ pagination.php
	â”œâ”€â”€ woocommerce
    â”‚   â””â”€â”€ checkout
    â”œâ”€â”€ template-2col.php
    â””â”€â”€ template-blank.php
```

views é™¤äº†æ”¾å°æ‡‰ slug çš„ç¯„æœ¬æª”ä¹‹å¤–ï¼Œä¹Ÿæ”¾äº†é é¢ç¯„æœ¬ï¼Œloops è³‡æ–™å¤¾æ”¾çš„æ˜¯éœ€è¦è·‘åœ¨ WP_Query è£¡é¢çš„åˆ—è¡¨é¡å…§å®¹ï¼Œè€Œ partials æ”¾çš„æ˜¯æ‰€æœ‰é é¢æœƒå…±ç”¨åˆ°çš„å…ƒä»¶ï¼Œåƒæ˜¯åˆ†é å°è¦½ paginationã€‚å¦‚æœæ˜¯åš WooCommerce çš„ Extension æˆ‘æœƒå†å¤šé–‹ä¸€å€‹è³‡æ–™æ”¾ WC çš„ç¯„æœ¬æª”ï¼Œé€™æ¨£å°±èƒ½å¾å¤–æ›ä¾†ä¿®æ”¹ WC ç›¸é—œé é¢çš„å…§å®¹ã€‚

å†ä¾†æ˜¯ src è£¡é¢çš„çµæ§‹ï¼Œå˜—è©¦äº†å¾ˆå¤šå‘½åæ–¹æ³•ï¼Œæœ€å–œæ­¡çš„æ‡‰è©²æ˜¯ MVC æ¨¡å¼ï¼š

```
my-plugin
â””â”€â”€ src
    â”œâ”€â”€ controllers
    â”‚   â””â”€â”€ cpt.php
    â””â”€â”€ models
        â””â”€â”€ cpt.php
```

View çš„éƒ¨åˆ†æˆ‘æŠŠå®ƒç¨ç«‹åœ¨ src çš„è³‡æ–™å¤¾å¤–é¢ï¼ŒåŸå› æ˜¯ src çš„è³‡æ–™å¤¾æœƒé€é PSR-4 çš„ Autoload è¼‰å…¥ï¼Œä½† WP çš„ç¯„æœ¬æª”ä¸¦ä¸æ”¯æ´é€™æ¨£çš„æ©Ÿåˆ¶ï¼Œæ‰€ä»¥æŠŠ views ç¨ç«‹åœ¨ src ä»¥å¤–é¿å…è¢«è‡ªå‹•è¼‰å…¥ã€‚

Models è³‡æ–™å¤¾æˆ‘æ”¾çš„æ˜¯éœ€è¦æ–°å¢æˆ–ä¿®æ”¹è³‡æ–™åº«çµæ§‹çš„é¡åˆ¥ï¼Œæœ€å¸¸è¦‹çš„å°±æ˜¯æ–°å¢ Custom Post Typeï¼Œæˆ–æ˜¯éœ€è¦ä¿®æ”¹é è¨­çš„æ–‡ç« æˆ–é é¢ post typeã€æ–°å¢ optionsã€widgetï¼Œæˆ‘éƒ½æœƒæ”¾åœ¨ Models è³‡æ–™å¤¾ä¸‹é¢ã€‚

Controllers å‰‡æ˜¯è² è²¬è™•ç† Models è£¡é¢å„ç¨® post type æˆ–æ˜¯ option çš„ CRUDï¼Œä»¥åŠå„ç¨® WP å…§å»ºæ©Ÿåˆ¶çš„è™•ç†ï¼Œåƒæ˜¯ REST APIã€WP Cronã€Shortcode ç­‰ç­‰ï¼ŒåŸºæœ¬ä¸Šé€™å€‹è³‡æ–™å¤¾æœƒæ”¾æ‰€æœ‰çš„é‚è¼¯è™•ç†é¡åˆ¥ï¼Œéœ€è¦å‘¼å«é¡åˆ¥çš„ç¨‹å¼ä¹Ÿæ˜¯æ”¾åœ¨é€™é‚Šã€‚

å¦‚æœæœ‰å¤šå€‹ CPT éœ€è¦è™•ç†å¤šç¨®æ“ä½œï¼Œæˆ‘æœƒå†æ–°å¢æ–°çš„è³‡æ–™å¤¾ä¾†åšå€åˆ†ï¼š

```
my-plugin
â””â”€â”€ src
    â”œâ”€â”€ controllers
    â”‚   â”œâ”€â”€ cpt.php
    â”‚   â”œâ”€â”€ cpt1
    â”‚   â”‚   â”œâ”€â”€ Api.php
    â”‚   â”‚   â”œâ”€â”€ Router.php
    â”‚   â”‚   â”œâ”€â”€ Post.php	
    â”‚   â”‚   â””â”€â”€ Shortcode.php
    â”‚   â””â”€â”€ cpt2
    â”‚       â”œâ”€â”€ Post.php
    â”‚       â””â”€â”€ Widget.php
    â””â”€â”€ models
        â””â”€â”€ cpt.php
```

é›–ç„¶å¾ MVC çš„è§’åº¦ä¸‹å»åˆ†é¡çœ‹ä¼¼å¾ˆæ¸…æ¥šï¼Œä½†å¯¦ä½œå¾Œå¸¸ç™¼ç¾è‡ªå·±æœƒæ··æ·† M è·Ÿ C çš„éƒ¨åˆ†ï¼Œæˆ‘æ›¾ç¶“åœ¨ä¸€å€‹å°ˆæ¡ˆä¸­æŠŠ Shortcode æ”¾åœ¨ Controllersï¼Œå¦ä¸€å€‹å°ˆæ¡ˆå»æ”¾åœ¨ Models è£¡é¢ï¼Œæˆ–æ˜¯è¦è¨»å†Š Rest API æˆ‘å°±å¸¸æœƒèˆ‰æ£‹ä¸å®šï¼Œé€™åˆ°åº•è©²æ”¾åœ¨å“ªè£¡å¥½ï¼Ÿ

æ–¼æ˜¯ç´¢æ€§å°±ä¸åˆ† Models è·Ÿ Controllers äº†ï¼Œç›´æ¥ä»¥ WordPress è³‡æ–™è¡¨çµæ§‹ä¾†å€åˆ†è³‡æ–™å¤¾ï¼š

```
my-plugin
â””â”€â”€ src
    â”œâ”€â”€ posts
    â”‚   â”œâ”€â”€ cpt1
    â”‚   â”‚   â”œâ”€â”€ Ajax.php
    â”‚   â”‚   â”œâ”€â”€ Field.php
    â”‚   â”‚   â””â”€â”€ Cpt1.php
    â”‚   â””â”€â”€ cpt2
    â”‚       â”œâ”€â”€ Api.php
    â”‚       â”œâ”€â”€ Cpt2.php
    â”‚       â””â”€â”€ Shortcode.php
    â”œâ”€â”€ terms
    â”‚   â”œâ”€â”€ taxonomy1
    â”‚   â”‚   â””â”€â”€ Field.php
    â”‚   â””â”€â”€ taxonomy2
    â”‚       â””â”€â”€ Api.php
    â”œâ”€â”€ options
    â”‚   â”œâ”€â”€ Field.php
    â”‚   â””â”€â”€ Menu.php
    â””â”€â”€ user
        â””â”€â”€ Field.php
```

æœ€å¸¸è™•ç†çš„æ˜¯ wp_postsï¼Œæ‰€ä»¥ posts è³‡æ–™å¤¾ä¸‹é¢æœƒæ”¾å„å€‹ CPT çš„è³‡æ–™å¤¾ï¼Œoptions æ˜¯åšè¨­å®šé é¢çš„ï¼Œå°æ‡‰çš„è³‡æ–™è¡¨æ˜¯ wp_optionsï¼Œuser æ˜¯ä½¿ç”¨è€…ç›¸é—œï¼Œå°æ‡‰çš„è³‡æ–™è¡¨æ˜¯ wp_usersï¼Œè‡³æ–¼ Taxonomy æˆ‘ä¹Ÿæœƒè·Ÿ Post æ‹†é–‹ç¨ç«‹æ”¾åœ¨ terms çš„è³‡æ–™å¤¾åº•ä¸‹ï¼Œåœ¨çµæ§‹ä¸Šæœƒæ›´æ¸…æ¥šäº›ã€‚

ç„¶å¾Œæ¯å€‹ cpt çš„è³‡æ–™å¤¾åº•ä¸‹ï¼Œæœƒæœ‰ä¸€æ”¯è·Ÿ CPT slug åŒåçš„æª”æ¡ˆï¼Œè£¡é¢æ”¾çš„æœƒæ˜¯è¨»å†Š CPT çš„åŠŸèƒ½ï¼Œä¸‹ä¸€ç¯‡æ–‡ç« æœƒç¤ºç¯„å¦‚ä½•ä½¿ç”¨ Composer å¥—ä»¶ä¾†è¨»å†Š CPTï¼Œå…¶ä»–çš„ Field.php ã€Ajax.phpã€Api.php å°±æ˜¯ç®¡ç†è©² CPT çš„ç›¸å°æ‡‰åŠŸèƒ½ã€‚

æ‰€ä»¥æ•´å€‹è³‡æ–™å¤¾çš„é‚è¼¯å°±æ˜¯ä»¥è³‡æ–™é¡å‹ > åŠŸèƒ½ä¾†å€åˆ†ï¼Œå°æˆ‘ä¾†èªªå¯ä»¥å†ä¹Ÿä¸ç”¨åˆ¤æ–·é€™åŠŸèƒ½åˆ°åº•æ˜¯å±¬æ–¼ Models é‚„æ˜¯ Controllersã€‚

æœ€å¾Œå‰‡æ˜¯å–®å…ƒæ¸¬è©¦çš„è³‡æ–™å¤¾ï¼š

```
my-plugin
â””â”€â”€ tests
    â””â”€â”€ cpt
        â””â”€â”€ cptTest.php
```

æ¸¬è©¦çš„éƒ¨åˆ†æ¯”è¼ƒè¤‡é›œï¼Œä¹‹å¾Œæœƒå†ä»¥ç¨ç«‹ç¯‡å¹…ä¾†é€²è¡Œèªªæ˜ã€‚

å¦å¤–å¦‚æœæ˜¯è¦åš i18n æœ¬åœ°åŒ–ï¼Œå°±éœ€è¦å†æ–°å¢ä¸€å€‹ languages è³‡æ–™å¤¾ï¼Œç¿»è­¯ç”¨çš„ .pot æª”å¯ä»¥é€é WP CLI ç”¢ç”Ÿã€‚

```
$ wp i18n make-pot . languages/my-plugin.pot
```

è³‡æ–™å¤¾çµæ§‹æœƒæ˜¯é€™æ¨£ï¼š
```
my-plugin
â””â”€â”€ languages
    â””â”€â”€ my-plugin.pot
```

æœ€å¾Œè¦–å°ˆæ¡ˆçš„éœ€æ±‚ï¼Œè³‡æ–™å¤¾çµæ§‹å¯ä»¥æ˜¯é€™æ¨£ï¼š

```
my-plugin
â”œâ”€â”€ my-plugin.php
â””â”€â”€ src
    â””â”€â”€ cpt1
        â””â”€â”€ Cpt1.php
```

ä¹Ÿå¯ä»¥é€æ¼¸ç™¼å±•æˆé€™æ¨£ï¼š

```
my-plugin
â”œâ”€â”€ assets
â”‚   â”œâ”€â”€ css
â”‚   â”‚   â”œâ”€â”€ admin.css
â”‚   â”‚   â””â”€â”€ public.css
â”‚   â”œâ”€â”€ img
â”‚   â”‚   â””â”€â”€ img1.jpg
â”‚   â””â”€â”€ js
â”‚       â”œâ”€â”€ admin.js
â”‚       â”œâ”€â”€ ajax.js
â”‚       â””â”€â”€ public.js
â”œâ”€â”€ my-plugin.php
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ posts
â”‚   â”‚   â”œâ”€â”€ cpt1
â”‚   â”‚   â”‚   â”œâ”€â”€ Ajax.php
â”‚   â”‚   â”‚   â”œâ”€â”€ Field.php
â”‚   â”‚   â”‚   â””â”€â”€ Cpt1.php
â”‚   â”‚   â””â”€â”€ cpt2
â”‚   â”‚       â”œâ”€â”€ Api.php
â”‚   â”‚       â”œâ”€â”€ Cpt2.php
â”‚   â”‚       â””â”€â”€ Shortcode.php
â”‚   â”œâ”€â”€ terms
â”‚   â”‚   â”œâ”€â”€ taxonomy1
â”‚   â”‚   â”‚   â””â”€â”€ Field.php
â”‚   â”‚   â””â”€â”€ taxonomy2
â”‚   â”‚       â””â”€â”€ Api.php
â”‚   â”œâ”€â”€ options
â”‚   â”‚   â”œâ”€â”€ Field.php
â”‚   â”‚   â””â”€â”€ Menu.php
â”‚   â””â”€â”€ user
â”‚       â””â”€â”€ Field.php
â”œâ”€â”€ tests
â”‚   â””â”€â”€ cpt
â”‚       â””â”€â”€ cptTest.php
â””â”€â”€ views
    â”œâ”€â”€ loops
    â”‚   â””â”€â”€ post.php
    â”œâ”€â”€ page-about.php
    â”œâ”€â”€ page-contact.php
    â”œâ”€â”€ partials
    â”‚   â””â”€â”€ pagination.php
    â”œâ”€â”€ template-2col.php
    â”œâ”€â”€ template-blank.php
    â””â”€â”€ woocommerce
```

åœ¨å¯¦å‹™ä¸­æˆ‘æœ€å¸¸è®Šå‹•çš„éƒ¨åˆ†æ˜¯ src è³‡æ–™å¤¾ï¼Œé™¤äº†éœ€æ±‚çš„æ–°å¢å¤–ï¼Œåšç¨‹å¼ç¢¼é‡æ§‹ä¹Ÿéƒ½æœƒå¸¸å¸¸ä¿®æ”¹é€™é‚Šï¼Œä»¥å¾€åªè¦è³‡æ–™å¤¾åç¨±æˆ–æ˜¯æª”æ¡ˆæœ‰æ–°å¢åˆªé™¤ï¼Œé€éæ‰‹å‹•å¼•å…¥çš„æ–¹å¼å°±å¿…é ˆè¦å…¨éƒ¨ä¿®æ”¹ï¼Œæœ‰æ²’æœ‰æ›´æ–¹ä¾¿ä¸”æ›´å½ˆæ€§çš„ä½œæ³•å‘¢ï¼Ÿæœ‰ï¼ç­”æ¡ˆå°±æ˜¯ Composerã€‚

### 2.è¨­å®š Composer ç’°å¢ƒ

å®‰è£ Composer çš„æ•™å­¸ç¶²è·¯éå¸¸å¤šï¼Œé€™é‚Šä¸»è¦ç¤ºç¯„çµ¦ WordPress å¤–æ›é–‹ç™¼è€…çš„ç’°å¢ƒè¨­å®šã€‚ç¬¬ä¸€æ­¥å…ˆé–‹å•Ÿçµ‚ç«¯æ©Ÿç„¶å¾ŒæŠŠç›®éŒ„åˆ‡åˆ°æ­£åœ¨é–‹ç™¼çš„å¤–æ›åº•ä¸‹ï¼š

```
$ cd wp-content\plugins\my-plugin
```

ç„¶å¾ŒåŸ·è¡Œ composer init

```
$ composer init
```

composer æœƒç”¨å°è©±å¼çš„ä»‹é¢ä¾†å”åŠ©æˆ‘å€‘é€²è¡Œè¨­å®šï¼Œä¾åºè¦å›ç­”å…­å€‹å•é¡Œï¼š

```
This command will guide you through creating your composer.json config.

Package name (<vendor>/<name>) [oberonlai/my-plugin]: 
Description []: 
Author [Oberon Lai <m615926@gmail.com>, n to skip]: 
Minimum Stability []: stable
Package Type (e.g. library, project, metapackage, composer-plugin) []: project
License []: propreitary
```

åŸºæœ¬ä¸Šå› ç‚ºé€™ä¸æ˜¯è¦ä¸Šå‚³åˆ° Composer å¥—ä»¶åº« Packagist çš„å¥—ä»¶ï¼Œæˆ‘ç¿’æ…£éƒ½ç›´æ¥æ¡ç”¨é è¨­å€¼ï¼Œå¦‚æœæœ‰ç‰¹æ®Šéœ€æ±‚å¯ä»¥å†å€‹åˆ¥èª¿æ•´ï¼Œç¬¬ä¸ƒé¡Œæ˜¯é—œéµï¼Œå®ƒæœƒå•ä½ æ˜¯å¦è¦å®‰è£ç›¸ä¾å¥—ä»¶ï¼š

```
Define your dependencies.

Would you like to define your dependencies (require) interactively [yes]? 
Search for a package: a7/autoload
Enter the version constraint to require (or leave blank to use the latest version): 
```

è¼¸å…¥å¥—ä»¶åç¨± a7/autoload æŒ‰ä¸‹ Enter å¾Œ Composer å°±æœƒé–‹å§‹è‡ªå‹•æœå°‹ Packagist ä¸Šé¢çš„æ‰€æœ‰ PHP å¥—ä»¶ä¸¦ä¸”æŒ‡å®šå®‰è£çš„ç‰ˆæœ¬ï¼Œå¦‚æœè¦å®‰è£æœ€æ–°ç‰ˆå°±ç›´æ¥ Enter ä¸‹ä¸€æ­¥å³å¯ï¼Œ[a7/autoload](https://github.com/a7/autoload) é€™å€‹å¥—ä»¶å¯ä»¥æŠŠæŒ‡å®šè³‡æ–™å¤¾è£¡é¢çš„æª”æ¡ˆå…¨éƒ¨è‡ªå‹•è¼‰å…¥ï¼Œå¦‚æœæ²’æœ‰å®ƒå°±éœ€è¦ä¸€å€‹ä¸€å€‹æ‰‹å‹•æŒ‡å®šè¦è‡ªå‹•è¼‰å…¥çš„è³‡æ–™å¤¾ã€‚

å®Œæˆå¾Œæ¥ä¸‹ä¾†åˆæœƒå†å•ä¸€æ¬¡æ˜¯å¦è¦æœå°‹å…¶ä»–å¥—ä»¶ï¼Œé€™é‚Šæˆ‘å€‘ä»€éº¼éƒ½ä¸è¼¸å…¥ç›´æ¥ä¸‹ Enter å³å¯ã€‚

æ¥ä¸‹ä¾†å®ƒæœƒè©¢å•æ˜¯å¦è¦å®‰è£åªæœ‰åœ¨é–‹ç™¼æ™‚æ‰éœ€è¦çš„å¥—ä»¶ï¼Œåƒæ˜¯åšå–®å…ƒæ¸¬è©¦ PHPUnit é€™ä¸€é¡åªæœƒåœ¨é–‹ç™¼ç’°å¢ƒä¸­éœ€è¦çš„å¥—ä»¶å°±å¯ä»¥åœ¨é€™é‚Šå®‰è£ï¼Œä½†ç›®å‰æˆ‘å€‘å…ˆè·³éï¼Œä¹‹å¾Œè¬›è§£å–®å…ƒæ¸¬è©¦çš„æ–‡ç« å†å¦è¡Œèªªæ˜ï¼š

```
Would you like to define your dev dependencies (require-dev) interactively [yes]? no
```

æ¥ä¸‹ä¾†å°±æœƒçœ‹åˆ°æ•´å€‹ Composer è¨­å®šæª”çš„è‰ç¨¿ï¼Œå®ƒæœƒè«‹ä½ ç¢ºèªæ˜¯å¦æ­£ç¢ºï¼Œè¼¸å…¥ Enter å³å¯ï¼Œé€™æ¨£å°±å®Œæˆ composer.json è¨­å®šæª”äº†ã€‚

```
{
    "name": "oberonlai/my-plugin",
    "type": "project",
    "require": {
        "a7/autoload": "^2.1"
    },
    "license": "propreitary",
    "authors": [
        {
            "name": "Oberon Lai",
            "email": "m615926@gmail.com"
        }
    ],
    "minimum-stability": "stable"
}

Do you confirm generation [yes]? yes
```

æœ€å¾Œå®ƒæœƒå•ä½ æ˜¯å¦è¦å®‰è£è¨­å®šæª”ä¸­çš„å¥—ä»¶ï¼ŒæŒ‰ä¸‹ Enter å³å¯

```
Would you like to install dependencies now [yes]? yes
```

æœ€å¾Œå°±æœƒå‡ºç¾å®‰è£å®Œæˆçš„è¨Šæ¯ï¼Œé€™å°±ä»£è¡¨æˆ‘å€‘å·²ç¶“æŠŠ Composer å·²ç¶“æ‰€éœ€å¥—ä»¶æº–å‚™å®Œæˆï¼š

```
No lock file found. Updating dependencies instead of installing from lock file. Use composer update over composer install if you do not have a lock file.
Loading composer repositories with package information
Updating dependencies
Lock file operations: 1 install, 0 updates, 0 removals
  - Locking a7/autoload (2.1)
Writing lock file
Installing dependencies from lock file (including require-dev)
Package operations: 1 install, 0 updates, 0 removals
  - Installing a7/autoload (2.1): Extracting archive
Generating autoload files
```

è§€å¯Ÿæˆ‘å€‘å¤–æ›çš„ç›®éŒ„ï¼Œæœƒç™¼ç¾å¤šäº† composer.jsonã€composer.lock ä»¥åŠ vendor è³‡æ–™å¤¾ï¼Œæœªä¾†æˆ‘å€‘ä»»ä½•å¾ Composer å®‰è£çš„å¥—ä»¶éƒ½æœƒæ”¾åœ¨ vendor é€™å€‹è³‡æ–™å¤¾åº•ä¸‹ï¼Œè‡³æ–¼è©²å¦‚ä½•å¼•å…¥é€™äº›å¥—ä»¶ä»¥åŠè®“ src è³‡æ–™å¤¾çš„æª”æ¡ˆå¯ä»¥è‡ªå‹•è¼‰å…¥å‘¢ï¼Ÿè®“æˆ‘å€‘é–‹å§‹å¯« code å§ï½

### 3.åŠ å…¥ Autoload æ©Ÿåˆ¶

æ‰“é–‹å¤–æ›çš„ä¸»æª”æ¡ˆï¼Œæˆ‘æŠŠä¸€äº›å¸¸ç”¨çš„å¯«æ³•å­˜æˆäº† VSCode çš„ Snippetï¼Œå…§å®¹å¦‚ä¸‹ï¼š

```php
<?php

 /**
 * @link              https://oberonlai.blog
 * @since             1.0.0
 * @package           ODS
 *
 * @wordpress-plugin
 * Plugin Name:       Oberon Plugin
 * Plugin URI:        https://oberonlai.blog
 * Description:       Oberon Lai Blog Demo Plugins
 * Version:           1.0.0
 * Author:            Oberon Lai
 * Author URI:        https://oberonlai.blog
 * License:           GPL-2.0+
 * License URI:       http://www.gnu.org/licenses/gpl-2.0.txt
 * Text Domain:       ods
 * Domain Path:       /languages
 */


if ( ! defined( 'ABSPATH' ) ) {
  exit;
}

define('ODS_VERSION', '1.0.0');
define('ODS_PLUGIN_URL', plugin_dir_url(__FILE__));
define('ODS_PLUGIN_DIR', plugin_dir_path(__FILE__));
define('ODS_PLUGIN_BASENAME', plugin_basename(__FILE__));

/**
 * Autoload
 */
require_once( ODS_PLUGIN_DIR . 'vendor/autoload.php' );
\A7\autoload( ODS_PLUGIN_DIR . 'src' );

```

å¤–æ› Header é ­å¹¾è¡Œçš„è¨»è§£æ˜¯å¿…è¦çš„ï¼Œå…·é«”å…§å®¹å¯ä»¥åƒè€ƒ Handbookï¼Œdefine çš„å¸¸æ•¸å®šç¾©æˆ‘æœƒå…ˆæŠŠå¹¾å€‹å¸¸ç”¨çš„è·¯å¾‘å­˜èµ·ä¾†ï¼Œå› ç‚º plugin_dir_xxx åœ¨ä¸åŒå±¤ç´šçš„æª”æ¡ˆä¸‹æœƒå°æ‡‰åˆ°ä¸åŒçš„è·¯å¾‘ï¼Œç›´æ¥åœ¨ä¸»æª”æ¡ˆå­˜èµ·ä¾†æ‰èƒ½æ­£ç¢ºå°æ‡‰åˆ°å¤–æ›çš„æ ¹ç›®éŒ„ã€‚

å†å¾€ä¸‹çœ‹å°±æ˜¯æœ€é—œéµçš„ Autoloadï¼Œç¬¬ä¸€å€‹ require_once è¼‰å…¥çš„æ˜¯ vendor/autoload.phpï¼Œä¹Ÿå°±æ˜¯é€é Composer å®‰è£çš„å¥—ä»¶åªéœ€è¦é€™ä¸€è¡Œå°±å¯ä»¥å…¨éƒ¨è‡ªå‹•å¼•å…¥ï¼Œä½¿ç”¨æ™‚åªéœ€è¦é€é Namespace çš„ use é—œéµå­—å³å¯ä½¿ç”¨ï¼Œ

è€Œä¸‹ä¸€è¡Œçš„ \\A7\\autoload å‰‡æ˜¯æŒ‡å®šè‡ªå‹•è¼‰å…¥ src ç›®éŒ„åº•ä¸‹æ‰€æœ‰çš„æª”æ¡ˆï¼Œä¸ç®¡æœ‰å¹¾å±¤ç›®éŒ„ã€å¤šå°‘æª”æ¡ˆï¼Œé€éå®ƒå°±å¯ä»¥è‡ªå‹•å®Œæ•´è¼‰å…¥ï¼Œç¸±ä½¿ä¿®æ”¹äº†æª”åæˆ–æ˜¯è³‡æ–™å¤¾åç¨±ï¼Œä¾èˆŠéƒ½èƒ½æ­£å¸¸é‹ä½œã€‚

a7\\autoload æ˜¯ç”± Aaron Holbrook æ‰€é–‹ç™¼çš„ï¼Œè§€å¯Ÿä»–çš„ç¨‹å¼ç¢¼ï¼Œä»–ä½¿ç”¨äº†è¿´åœˆå»æƒææŒ‡å®šç›®éŒ„çš„æ‰€æœ‰æª”æ¡ˆï¼Œç„¶å¾Œå†é€é autoload æ©Ÿåˆ¶å»é€ä¸€è¼‰å…¥ï¼Œé›–ç„¶è©²å¥—ä»¶å·²ç¶“æœ‰å…©å¹´å¤šæ²’æ›´æ–°äº†ï¼Œä½†ç”¨åˆ°ç›®å‰ç‚ºæ­¢éƒ½éå¸¸çš„ç©©å®šæ²’å‡ºéä»»ä½•å•é¡Œï¼Œå› æ­¤å®ƒæˆç‚ºæˆ‘æ¯å€‹å°ˆæ¡ˆçš„å¿…å‚™å¥—ä»¶ã€‚

åˆ°é€™é‚Šè‡ªå‹•è¼‰å…¥å°±å®Œæˆäº†ï¼Œæ—¥å¾Œå¦‚æœæˆ‘æ–°å¢æˆ–ä¿®æ”¹ä»»ä½• src è³‡æ–™å¤¾è£¡é¢çš„ä»»ä½•æª”æ¡ˆåç¨±ï¼Œå°±å†ä¹Ÿä¸ç”¨é‡æ–°èª¿æ•´è¼‰å…¥çš„è·¯å¾‘äº†ï¼Œä¸€å‹æ°¸é€¸ ğŸ‰

### 4. Git è¨­å®š

ç‚ºäº†è¦èƒ½åšåˆ°ç‰ˆæœ¬æ§ç®¡èˆ‡è‡ªå‹•éƒ¨ç½²ï¼ŒGit ç‰ˆæ§ä¹Ÿæ˜¯æˆ‘æ¯å€‹å¿…ç”¨çš„å·¥å…·ï¼Œæ—©æœŸçœ‹åˆ°æœ‹å‹çš„ä½œæ³•æ˜¯ç›´æ¥æŠŠæ•´å€‹ wp-content è³‡æ–™å¤¾éƒ½ç´å…¥ç‰ˆæ§ï¼Œå¥½è™•æ˜¯æ‰€æœ‰å¤–æ›çš„æ›´æ–°éƒ½å¯ä»¥å¾ git ä¾†ç®¡ç†ï¼Œæ–¼æ˜¯æˆ‘ä¹Ÿæ¡ç”¨é€™æ¨£çš„ä½œæ³•ï¼Œä½†ç¶“éå¹¾å€‹å°ˆæ¡ˆå¾Œç™¼ç¾æœ‰äº›å•é¡Œï¼š

é¦–å…ˆæ˜¯å¿…é ˆè¦æŠŠå®¢æˆ¶æ•´å€‹ç«™çš„ wp-content éƒ½ clone ä¸‹ä¾†ï¼Œé‡åˆ°æ¯”è¼ƒå¤§å‹çš„ç«™é€™å°æˆ‘ 128GB çš„ MBP è² æ“”å¾ˆå¤§...

å…¶æ¬¡åœ¨è¨­å®š .gitignore æ™‚è¦è™•ç†æ¯”è¼ƒå¤šçš„éƒ¨åˆ†ï¼Œæœ‰æ™‚å€™ä¹Ÿæœƒä¸å°å¿ƒæŠŠéœ€è¦ ignore çš„æ±è¥¿çµ¦ commit é€²å»ã€‚å¦å¤–å¦‚æœè¦æä¾›çµ¦å®¢æˆ¶ä¸‹è¼‰æ­£åœ¨é–‹ç™¼ä¸­çš„å¤–æ›æ™‚ï¼Œç›´æ¥ download å°±æœƒæŠ“å›ä¸€å¤§åŒ…ï¼Œå®¢æˆ¶é‚„è¦å¾ä¸€å¤§åŒ…ä¹‹ä¸­å»æ‰¾åˆ°æ­£ç¢ºçš„å¤–æ›ã€‚

æ‰€ä»¥æˆ‘ç¾åœ¨éƒ½æ˜¯ä¸€æ”¯å¤–æ›åšä¸€å€‹ç‰ˆæ§ï¼Œå¥½è™•æ˜¯æœ¬æ©Ÿé–‹ç™¼ç’°å¢ƒåªè¦å®‰è£å¯èƒ½éœ€è¦çš„å¤–æ›å³å¯ï¼Œä¸ç”¨æŠŠæ•´åŒ… wp-content è·Ÿè³‡æ–™åº«è¼‰åˆ°è‡ªå·±çš„é›»è…¦ï¼Œç„¶å¾Œ gitignore ä¹Ÿæ¯”è¼ƒå¥½è¨­å®šï¼Œä¸»è¦æˆ‘æœƒæŠŠæ¸¬è©¦ç›¸é—œä»¥åŠ vendor è³‡æ–™å¤¾å¿½ç•¥æ‰ï¼Œ

æ¸¬è©¦ä¸»è¦æœƒåœ¨æœ¬æ©Ÿä»¥åŠæ¸¬è©¦æ©ŸåŸ·è¡Œï¼Œæ‰€ä»¥ä¸å®œæŠŠæ‰€æœ‰çš„å¥—ä»¶éƒ½ä¸Šå‚³åˆ°æ­£å¼æ©Ÿï¼Œé€™éƒ¨åˆ†éœ€è¦é€éè‡ªå‹•åŒ–éƒ¨ç½²å·¥å…·ä¾†æ±ºå®šå“ªäº›å¥—ä»¶è©²è£å“ªäº›ä¸ç”¨è£ï¼Œé€™éƒ¨åˆ†æœƒåœ¨è‡ªå‹•éƒ¨ç½²ä¸€æ–‡ä¸­æåŠã€‚

å¦å¤–çš„å¥½è™•æ˜¯åœ¨ Github é é¢ä¸Šå¯ä»¥è¨­å®š Releases åŠŸèƒ½ä¾†è®“å®¢æˆ¶ä¸‹è¼‰æŒ‡å®šç‰ˆæœ¬ï¼Œä¹Ÿèƒ½çœ‹åˆ°æ¯å€‹ç‰ˆæœ¬æ›´æ–°çš„é …ç›®ã€‚

ä½†å¦‚æœä¸€å€‹å°ˆæ¡ˆè£¡é¢éœ€è¦é–‹ç™¼å¤šæ”¯å¤–æ›ï¼Œæˆ–æ˜¯æœ‰æ”¹éä¸€äº›æ—¢æœ‰çš„å¤–æ›éœ€è¦ç´å…¥ç‰ˆæ§æ™‚ï¼Œæ•¸é‡ä¸€å¤šå°±æœƒä¸å¥½ç®¡ç†ï¼Œæ–¼æ˜¯æˆ‘æ¡ç”¨ Github çš„ Organization ä¾†é€²è¡Œåˆ†é¡ã€‚æŠŠåŒä¸€å€‹å°ˆæ¡ˆä¸åŒå¤–æ›çš„å­˜æ”¾åº«éƒ½é›†ä¸­ç®¡ç†ã€‚

åœ¨æœ¬æ©Ÿçš„éƒ¨åˆ†å°±ä½¿ç”¨ VSCode çš„å·¥ä½œå€åŠŸèƒ½ï¼ŒæŠŠéœ€è¦è™•ç†åˆ°çš„å¤–æ›éƒ½åŠ é€²åˆ°åŒä¸€å€‹å·¥ä½œå€ï¼Œç„¶å¾Œåœ¨ commit çš„æ™‚å€™é€éå…§å»ºçš„ Git å·¥å…·å„è‡ªè™•ç†ã€‚

### 5.WordPress Coding Standard

åˆ°é€™é‚Šå°±å·²ç¶“å®Œæˆäº†é–‹ç™¼ç’°å¢ƒçš„åŸºæœ¬è¨­å®šï¼Œä½†åœ¨çœŸæ­£é–‹å§‹ coding ä¹‹å‰ï¼Œæœ‰ä»¶äº‹é›–ç„¶ä¸æ˜¯å¼·åˆ¶ä½†æˆ‘é‚„æ˜¯é€¼è‘—è‡ªå·±ç¿’æ…£ï¼Œé‚£å°±æ˜¯ WordPress ç¨‹å¼ç¢¼è¦ç¯„ã€‚

PHP æœ‰ä¸€å¥—è‡ªå·±çš„ç¨‹å¼ç¢¼è¦ç¯„ï¼Œå«åš PHP Standards Recommendations ( PSR )ï¼Œé›–ç„¶ WordPress æ˜¯ç”¨ PHP å¯«çš„ï¼Œä½†åœ¨è¦ç¯„ä¸Šæœ‰è¨±å¤šåœ°æ–¹ä¸ä¸€æ¨£ï¼Œé›–ç„¶è‡ªå·±æœ¬èº«å¾ä¾†æ²’åœ¨ç…§ä»€éº¼è¦ç¯„å¯«ç¨‹å¼ï¼Œä½†è‡ªå¾çŸ¥é“æœ‰é€™æ±è¥¿å¾Œå°±é‚„æ˜¯è¦ºå¾—è¦å˜—è©¦çœ‹çœ‹ï¼Œä¾†å»ºç«‹è‡ªå·±å¯«ç¨‹å¼çš„ç¿’æ…£ã€‚

å› ç‚ºæˆ‘éƒ½æ˜¯åœ¨å¯« WordPressï¼Œæ‰€ä»¥å°±ç†æ‰€ç•¶ç„¶çš„ç…§è‘— WP çš„è¦ç¯„èµ°ï¼Œä¸€é–‹å§‹å¾ˆä¸ç¿’æ…£ï¼Œåˆ°ç¾åœ¨è€å¯¦èªªä¹Ÿé‚„æ˜¯å¾ˆä¸è‡ªåœ¨ï¼Œå¸¸å¸¸å…‰æ˜¯è¦æ•´ç†æ ¼å¼å°±æ‰“æ–·äº†ç¨‹å¼é‚è¼¯çš„æ€è€ƒï¼Œæ‰€ä»¥æ•´ç†è¦ç¯„é€™ä»¶äº‹æˆ‘éƒ½æ˜¯æ”¾åœ¨é‡æ§‹çš„æ™‚å€™ä¾†åšï¼Œç¬¬ä¸€æ¬¡åœ¨å¯«çš„æ™‚å€™å°±ä¸ç®¡å®ƒäº†XD

å¾Œä¾†é€é Terry Lin å¤§å¤§çš„æ¨è–¦çŸ¥é“ VSCode æœ‰å€‹å¥½å·¥å…·å«åš [PHP Sniffer](https://marketplace.visualstudio.com/items?itemName=wongjn.php-sniffer)ï¼Œå¯ä»¥é¸æ“‡è¦éµå¾ªçš„è¦ç¯„ä¸¦ä¸”åœ¨ç·¨è¼¯å™¨ä¸­å³æ™‚é¡¯ç¤ºä¸ç¬¦åˆè¦ç¯„ä¹‹è™•ï¼Œå¦å¤–é‚„å¯ä»¥æ­é…å¿«é€Ÿéµé€²è¡Œä¿®æ­£ï¼Œå¯ä»¥æå®šæˆ‘æœ€è¨å­çš„è®Šæ•¸å°é½Šï¼š

![](https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-03.jpg)

![](https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-04.jpg)

è‡ªå‹•ä¿®æ­£å¯ä»¥ä¿®åˆ°ä¸ƒå…«æˆï¼Œå‰©ä¸‹çš„åªè¦è£œä¸Š PHPDoc çš„èªªæ˜å³å¯ã€‚

![](https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-01.jpg)

å®‰è£ PHP Sniffer è¨˜å¾—è¦åœ¨å®ƒçš„è¨­å®šè£¡é¢å°‡ PHPCS Standard æ”¹æˆ WordPressï¼Œé€™æ¨£å°±æœƒä»¥ WordPress çš„ç¨‹å¼ç¢¼è¦ç¯„ä¾†æª¢æŸ¥ï¼Œæ›´å¤šé€™éƒ¨åˆ†çš„èªªæ˜å¯ä»¥åƒè€ƒ[ä½¿ç”¨ PHP CodeSniffer å¹«åŠ©ç†Ÿæ‚‰ WordPress ç¨‹å¼ç¢¼é¢¨æ ¼](https://ithelp.ithome.com.tw/articles/10244668?sc=hot)ã€‚

å®‰è£èˆ‡è¨­å®šå®Œæˆå¾Œï¼Œå°±æœƒçœ‹åˆ°æœ‰ä¸ç¬¦åˆè¦ç¯„çš„åœ°æ–¹æœƒåœ¨ä¸‹é¢å‡ºç¾ç´…è‰²æ³¢æµªç·šï¼Œæ»‘é¼ åœç•™åœ¨ä¸Šé¢ä¸€ä¸‹ä¸‹å°±æœƒå‡ºç¾è¦ç¯„èªªæ˜ï¼Œç„¶å¾Œæ ¹æ“šèªªæ˜é€²è¡Œä¿®æ”¹å³å¯ã€‚

![](https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-02.jpg)

é€™é‚Šè£œå……ä¸€ä¸‹ï¼Œæœ‰æ™‚å€™æœƒé‡åˆ°ç„¡æ³•ç¬¦åˆè¦ç¯„çš„ç‹€æ³ï¼Œåƒæ˜¯è¦ä½¿ç”¨å…¶ä»–å¤–æ›çš„è®Šæ•¸åç¨±ï¼Œè€Œé€™å¤–æ›ä¸¦æ²’æœ‰ä¾ç…§è¦ç¯„ä¾†å¯«ï¼Œå¦å¤–ä¸€ç¨®ç‹€æ³æ˜¯ WordPress è¦ç¯„ä¸­é¡åˆ¥çš„æª”åè¦ç”¨ class-xxx.phpï¼Œæœ‰ template tag çš„è¦ç”¨ xxx-template.php é€™æ¨£ï¼Œ

ä½†åœ¨ç ”ç©¶ PHPUnit å–®å…ƒæ¸¬è©¦çš„æ™‚å€™ç™¼ç¾é€™æ¨£ç„¡æ³•é‹ä½œï¼ŒåŸå› æ˜¯ PHPUnit æ¸¬è©¦æª”è¦è¼‰å…¥è¢«æ¸¬è©¦çš„é¡åˆ¥æ™‚ï¼Œå¿…é ˆè¦ç”¨ PSR-4 çš„æ©Ÿåˆ¶ä¾†è¼‰å…¥ï¼Œç„¶å¾Œ PSR-4 è¦å®šé¡åˆ¥å«ä»€éº¼æª”åå°±è¦å«ä»€éº¼ï¼Œ

å¦‚æœé¡åˆ¥å«åš Userï¼Œå‰‡æª”åå°±ä¸€å®šè¦å«åš User.phpï¼Œå¯« class-User.php æœƒç„¡æ³•è¼‰å…¥ï¼Œæˆ‘æ¸¬è©¦éç”¨ require æˆ– include ä¹Ÿç„¡æ³•æ­£ç¢ºè¼‰å…¥ï¼Œæœ€å¾Œåªèƒ½å¿½ç•¥æŸäº› WordPress ç¨‹å¼ç¢¼è¦ç¯„ã€‚

å¿½ç•¥çš„å¸¸ç”¨æ–¹æ³•æœ‰å…©ç¨®ï¼Œåˆ†ç‚ºå¿½ç•¥ç•¶è¡Œæˆ–å¤šè¡Œï¼Œå–®è¡Œçš„è©±ç›´æ¥åœ¨è©²è¡Œå¾Œé¢åŠ å…¥è¨»è§£ï¼Œä¸¦æŠŠè¦å‰‡åç¨±å¯«åœ¨è¨»è§£ä¸­å³å¯

```php
$AbCd = 'bbb'; //phpcs:ignore WordPress.NamingConventions.ValidVariableName.VariableNotSnakeCase
```

WordPress ç¨‹å¼ç¢¼è¦ç¯„è¦å®šè®Šæ•¸åç¨±å¿…é ˆè¦ç”¨åº•ç·šè€Œéé§å³°å¼å¯«æ³•ï¼Œé€™æ™‚å€™ç›´æ¥åœ¨å¾Œé¢æ¥ä¸Š //phpcs:ignore åŠ è¦å‰‡åç¨±ï¼Œè¦å‰‡åç¨±å¯ä»¥åœ¨ PHP Sniffer è·³å‡ºçš„æç¤ºè¦–çª—ä¸­é€²è¡Œè¤‡è£½

![](https://oberonlai.blog/wp-content/uploads/wordpress-plugin-boilerplate/wordpress-plugin-boilerplate-05.jpg)

å¦‚æœä¸€æ¬¡è¦å¿½ç•¥å¤šè¡Œå°±æ›´ç°¡å–®äº†ï¼Œåªè¦ç”¨å…©å€‹è¨»è§£æŠŠè¦å¿½ç•¥çš„éƒ¨åˆ†åŒ…ä½å³å¯ï¼š

```php
// @codingStandardsIgnoreStart
$AbCd = 'bbb';
$ACaaa = 'abcdefg';
// @codingStandardsIgnoreEnd
```

## å°çµ

åœ¨é–‹ç™¼ WordPress å¤–æ›æ™‚æ•´åˆ Composer å¯ä»¥å¾ˆæ–¹ä¾¿çš„å®‰è£ä¸€äº›å¯¦ç”¨çš„å¥—ä»¶ä»¥åŠè‡ªç”±çµ„ç¹”è³‡æ–™å¤¾å…§å®¹ï¼Œé€™æ¨£åœ¨ç¨‹å¼é‡æ§‹ä¸Šèƒ½é”åˆ°æœ€å¤§çš„å½ˆæ€§ï¼Œå¦ä¸€æ–¹é¢ï¼Œé€é Coding Standard é¤Šæˆç¨‹å¼æ’°å¯«çš„ç¿’æ…£å¯ä»¥å¹«æœªä¾†çš„è‡ªå·±æˆ–æ˜¯åœ˜éšŠæˆå“¡ç†è§£ç¨‹å¼ç¢¼ï¼Œæ¥ä¸‹ä¾†æˆ‘å€‘ç¹¼çºŒæŒ–æ˜ Composer æœ‰ä»€éº¼å¥½ç‰©å¯ä»¥ç”¨å§ï½